{"1762357280274":{"actionType":"saveAll","createdAt":"1762357280274","actionID":"1762357280274","userID":"#TEMP","path":"system.capsules.3757bc92-00a4-4393-a217-cd330440d3b5.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"","newValue":"async () => {\n  const css1 =\n    \"color: limegreen; background-color: darkcyan; font-size: 11px; padding: 2px 6px; border-radius: 3px\";\n\n  const { getFirestore, doc, updateDoc } = await import(\"firebase/firestore\");\n  const fbInit = tools.getCtData(\"all.temp.fireInit\");\n  const db = getFirestore(fbInit);\n\n  const installmentId = tools.getCtData(\"sc.A10.forms.editChanges.installmentId\");\n  const lotId = tools.getCtData(\"sc.A10.currents.currId1\");\n  const data = tools.getCtData(\"sc.A10.forms.editChanges\");\n\n  console.log(\"%cinstallmentId a atualizar:\", css1, { installmentId });\n\n  try {\n    // Cria o ID sanitizado (sem pontos)\n    const newId = String(installmentId).replace(/\\./g, \"_\");\n\n    // Em vez de usar computed property, criamos o objeto manualmente\n    const fieldPath = \"installment.\" + newId;\n\n    // O updateDoc exige um objeto simples (chave: valor)\n    const dataToUpdate = {};\n    dataToUpdate[fieldPath] = data;\n\n    const refDoc = doc(db, \"lots\", lotId);\n\n    await updateDoc(refDoc, dataToUpdate);\n\n    // Limpa e fecha os toggles\n    tools.setData({ path: \"sc.A10.forms.editChanges\", value: {} });\n    tools.setData({ path: \"all.toggles.sideRight\", value: false });\n    tools.setData({ path: \"all.toggles.a10.addFinance\", value: false });\n\n    console.log(\"%cupdateDoc ok\", css1);\n    console.log(\"%cReferÃªncia do Documento\", css1, {\n      path: \"lots.\" + newId,\n      dataToUpdate,\n    });\n  } catch (err) {\n    console.error(\"Erro do updateDoc\", { err });\n  }\n};\n"}}