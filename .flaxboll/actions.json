{"1763479925678":{"actionType":"saveAll","createdAt":"1763479925678","actionID":"1763479925678","userID":"#TEMP","path":"system.capsules.8abe2226-b89c-4398-b08f-50f59f28b837.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números\n    let clean = txt.replace(/\\D/g, \"\");\n\n    // Limita a 8 dígitos (ddmmyyyy)\n    if (clean.length > 8) clean = clean.slice(0, 8);\n\n    let masked = \"\";\n\n    // Aplica máscara SEM USAR slice sobre texto já mascarado\n    if (clean.length > 0) masked = clean.slice(0, 2);\n    if (clean.length >= 3) masked += \"/\" + clean.slice(2, 4);\n    if (clean.length >= 5) masked += \"/\" + clean.slice(4, 8);\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.a1.iptChanges.startDate\"],\n        value: [String(masked)],\n      },\n    });\n\n  } catch (e) {\n    console.error(\"Erro na máscara de data:\", e);\n    return txt;\n  }\n}","newValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números\n    let clean = txt.replace(/\\D/g, \"\");\n\n    // Limita a 8 dígitos (ddmmyyyy)\n    if (clean.length > 8) clean = clean.slice(0, 8);\n\n    const masked = clean\n      ?.replace(/D+/g, \"\")\n      .replace(/(d{2})(d)/, \"!#!.!#!\")\n      .replace(/(d{3})(d)/, \"!#!.!#!\")\n      .replace(/(d{3})(d)/, \"!#!/!#!\")\n      .replace(/(d{4})(d)/, \"!#!-!#!\")\n      .replace(/(-d{2})d+?$/, \"!#!\");\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.a1.iptChanges.startDate\"],\n        value: [String(masked)],\n      },\n    });\n  } catch (e) {\n    console.error(\"Erro na máscara de data:\", e);\n    return txt;\n  }\n}"}}