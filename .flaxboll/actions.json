{"1764871329423":{"actionType":"saveAll","createdAt":"1764871329423","actionID":"1764871329423","userID":"#TEMP","path":"system.capsules.bfa025d1-6c92-4024-825d-39e449f3ff49.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // ───────────────────────────────\n    // Mantém apenas números (sem regex)\n    // ───────────────────────────────\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") {\n        clean += ch;\n      }\n    }\n\n    // Limita a 11 dígitos (telefone BR)\n    if (clean.length > 11) clean = clean.slice(0, 11);\n\n    // ───────────────────────────────\n    // Montagem da máscara de telefone\n    // ───────────────────────────────\n    let masked = \"\";\n    const len = clean.length;\n\n    if (len > 0) masked = \"(\" + clean.slice(0, 2);   // \"(\" + D1 D2\n    if (len >= 3) masked += \") \" + clean.slice(2, 7); // ) + espaço + até 5 dígitos seguintes\n    if (len >= 8) {\n      // separa parte inicial + hífen\n      const firstPart = clean.length === 11\n        ? clean.slice(2, 7)     // 5 dígitos (celular)\n        : clean.slice(2, 6);    // 4 dígitos (fixo)\n\n      const lastPart = clean.slice(firstPart.length + 2);\n\n      masked = \"(\" + clean.slice(0, 2) + \") \" + firstPart;\n\n      if (lastPart.length > 0) masked += \"-\" + lastPart;\n    }\n\n    console.log({ clean, masked });\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.C2.forms.iptsChanges.userPhone\"],\n        value: [String(masked)],\n      },\n    });\n\n  } catch (e) {\n    console.error(\"Erro na máscara de telefone:\", e);\n    return txt;\n  }\n}\n","newValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // ───────────────────────────────\n    // Mantém apenas números (sem regex)\n    // ───────────────────────────────\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") {\n        clean += ch;\n      }\n    }\n\n    // Limita a 11 dígitos (telefone BR)\n    if (clean.length > 11) clean = clean.slice(0, 11);\n\n    // ───────────────────────────────\n    // Montagem da máscara de telefone\n    // ───────────────────────────────\n    let masked = \"\";\n    const len = clean.length;\n\n    if (len > 0) masked = \"(\" + clean.slice(0, 2);   // \"(\" + D1 D2\n    if (len >= 3) masked += \") \" + clean.slice(2, 7); // ) + espaço + até 5 dígitos seguintes\n    if (len >= 8) {\n      // separa parte inicial + hífen\n      const firstPart = clean.length === 11\n        ? clean.slice(2, 7)     // 5 dígitos (celular)\n        : clean.slice(2, 6);    // 4 dígitos (fixo)\n\n      const lastPart = clean.slice(firstPart.length + 2);\n\n      masked = \"(\" + clean.slice(0, 2) + \") \" + firstPart;\n\n      if (lastPart.length > 0) masked += \"-\" + lastPart;\n    }\n\n    console.log({ clean, masked });\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.C2.forms.iptsChanges.userPhone\"],\n        value: [String(masked)],\n      },\n    });\n\n  } catch (e) {\n    console.error(\"Erro na máscara de telefone:\", e);\n    return txt;\n  }\n}"}}