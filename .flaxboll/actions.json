{"1764093654990":{"actionType":"saveAll","createdAt":"1764093654990","actionID":"1764093654990","userID":"#TEMP","path":"system.capsules.02bf0e4c-d34e-4219-89a4-6064dc82a8a8.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"(arg) => {\n\tconsole.log({arg});\n\tconst item =  tools.findFlatItem(arg);\n\tconst stepId = item.stepId;\nconsole.log({stepId});\n\tconst arrSteps = tools.getCtData('sc.C5.lists.list1');\nconsole.log({arrSteps});\n\tconst selectStep = arrSteps.find(i => i.stepId === stepId);\n}","newValue":"(arg) => {\n  console.log(\"onSelectStep\", { arg });\n\n  // --- valida arg ---\n  if (!arg) {\n    console.warn(\"onSelectStep: arg inválido\", arg);\n    return;\n  }\n\n  // --- encontra item clicado ---\n  const item = typeof tools.findFlatItem === \"function\"\n    ? tools.findFlatItem(arg)\n    : null;\n  console.log(\"onSelectStep item\", { item });\n\n  if (!item || typeof item !== \"object\") {\n    console.warn(\"onSelectStep: item não encontrado ou inválido\", item);\n    return;\n  }\n\n  const stepId = item.stepId;\n  console.log(\"onSelectStep stepId\", { stepId });\n\n  if (stepId == null) {\n    console.warn(\"onSelectStep: stepId ausente no item\", item);\n    return;\n  }\n\n  // --- pega lista de steps do estado ---\n  let arrSteps = tools.getCtData(\"sc.C5.lists.list1\");\n  console.log(\"onSelectStep arrSteps cru\", { arrSteps });\n\n  if (!arrSteps) {\n    console.warn(\"onSelectStep: arrSteps indefinido/vazio\");\n    return;\n  }\n\n  // garante array (caso venha como objeto)\n  if (!Array.isArray(arrSteps)) {\n    arrSteps = Object.values(arrSteps);\n  }\n\n  // --- encontra o step selecionado ---\n  const selectStep = arrSteps.find((i) => i && i.stepId === stepId);\n  console.log(\"onSelectStep selectStep\", { selectStep });\n\n  if (!selectStep) {\n    console.warn(\"onSelectStep: nenhum step encontrado com esse stepId\", {\n      stepId,\n      arrSteps,\n    });\n    return;\n  }\n\n  // opcional: guardar step atual em currents\n  tools.setData({\n    path: \"sc.C6.forms.editChanges.date\",\n    value: selectStep?.date ?? \"\",\n  });\n\n  tools.setData({\n    path: \"sc.C6.forms.editChanges.responsible\",\n    value: selectStep?.responsible ?? \"\",\n  });\n\n  tools.setData({\n    path: \"sc.C6.forms.editChanges.description\",\n    value: selectStep?.description ?? \"\",\n  });\n}"}}