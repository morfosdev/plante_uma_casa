{"1770661409457":{"actionType":"saveAll","createdAt":"1770661409457","actionID":"1770661409457","userID":"#TEMP","path":"system.capsules.09c4c85c-2dd8-439b-a0d8-80eeac65d933.capsUseCodeInfo.capsUseInputs.sss_freeValue-0.capsIptTxtValue","oldValue":"// ---------- import Packs\nimport JSON5 from \"json5\";\nimport React, { useEffect, useState } from \"react\";\nimport { Pressable, useWindowDimensions, View } from \"react-native\";\n\n// ---------- import Local Tools\nimport { useData } from \"../../..\";\nimport { getStlValues, getVarValue, mapElements, pathSel } from \"../project\";\n\nexport const css =\n  \"color: lightblue; background-color: black; font-size: 11px; padding: 2px 6px; border-radius: 3px\";\n\ntype Tconds = \"==\" | \"!=\" | \">\" | \"<\" | \"<=\" | \">=\";\ntype Tprops = {\n  pass: {\n    elementsProperties: any;\n    styles: string[];\n    functions: any[];\n    childrenItems: any;\n    args: any;\n  };\n};\n\nexport const processFunctions = async (arr: any[]) => {\n  const defaultVal = { trigger: \"\", arrFunctions: [] };\n\n  for (const fn of arr) {\n    if (typeof fn === \"function\") {\n      const result = await fn();\n      return result || defaultVal;\n    }\n  }\n\n  return defaultVal;\n};\n\nconst OPERATORS = {\n  \"==\": (a: any, b: any) => a == b,\n  \"!=\": (a: any, b: any) => a != b,\n  \">\": (a: any, b: any) => a > b,\n  \">=\": (a: any, b: any) => a >= b,\n  \"<\": (a: any, b: any) => a < b,\n  \"<=\": (a: any, b: any) => a <= b,\n} as const satisfies Record<Tconds, (a: any, b: any) => boolean>;\n\n// DynView / BOX\nexport const DynView = (props: Tprops) => {\n  if (!props) return <></>;\n  const { width } = useWindowDimensions();\n  const isMobile = width < 767;\n\n  const [sttTypeFunc, setTypeFunc] = useState(\"\");\n  const [sttCondParts, setCondParts] = useState({\n    path: \"\",\n    operator: \"==\",\n    compareVal: null,\n  });\n  const [sttPressFuncs, setPressFuncs] = useState<\n    Array<(args: any) => Promise<void>>\n  >([]);\n\n  const condRespVar = isMobile ? \"mobile\" : \"desktop\";\n\n  const condRespPath = React.useMemo(() => {\n    if (!sttCondParts.path) return \"\";\n    const isSpecialChar = sttCondParts.path.includes(\"@\");\n    return isSpecialChar\n      ? sttCondParts.path.replace(\"@media\", condRespVar)\n      : sttCondParts.path;\n  }, [sttCondParts.path, condRespVar]);\n\n  let varValue = useData((ct) =>\n    condRespPath ? pathSel(ct, condRespPath) : null,\n  );\n\n  // ---------- set Props\n  const { elementsProperties, functions } = props.pass;\n  const { childrenItems, args } = props.pass;\n  let { styles } = props.pass;\n\n  // ---- Media Breakpoints\n  const processedStyles = React.useMemo(() => {\n    if (!Array.isArray(styles)) {\n      return typeof styles === \"string\" ? [] : [];\n    }\n\n    return styles.map((style) => {\n      if (typeof style !== \"string\") return style;\n\n      if (isMobile) {\n        const mobilePart = style.match(\n          /@mediaMobiles*([sS]*?)(?=@mediaDesktop|$)/,\n        );\n        return mobilePart ? mobilePart[1] : style;\n      } else {\n        const desktopPart = style.match(/@mediaDesktops*([sS]*?)$/);\n        return desktopPart ? desktopPart[1] : style;\n      }\n    });\n  }, [styles, isMobile]);\n\n  const callFn = React.useCallback(async () => {\n    const { trigger, arrFunctions } = await processFunctions(functions);\n    setTypeFunc(trigger);\n    setPressFuncs(arrFunctions);\n\n    // ------- set Init Functions (Capsules)\n    if (trigger === \"on init\") {\n      for (const currFunc of arrFunctions) await currFunc(args);\n    }\n    if (trigger === \"on listen\") {\n      for (const currFunc of arrFunctions) {\n        const res: [string, Tconds, any] = await currFunc(args);\n        const path = res[0];\n        const operator = res[1];\n        const compareVal = res[2];\n\n        if (typeof path === \"string\") {\n          setCondParts({ path, operator, compareVal });\n        }\n      }\n    }\n  }, [functions, args]);\n\n  useEffect(() => {\n    callFn();\n  }, []);\n\n  // ---------- set Variables Styles (If Exists)\n  const stl = getStlValues(processedStyles);\n\n  // ------- set User Element Properties (If Exists)\n  const userElProps = React.useMemo(() => {\n    const props: any = {};\n\n    for (let strObj of elementsProperties) {\n      if (!strObj) continue;\n      if (typeof strObj !== \"string\") continue;\n\n      const trimmed = strObj.trim();\n      if (!trimmed.startsWith(\"{\") && !trimmed.startsWith(\"[\")) continue;\n\n      try {\n        const parsedObject = JSON5.parse(strObj);\n\n        for (const keyProp in parsedObject) {\n          const valueProp = parsedObject[keyProp];\n          const [hasVar, varValue] = getVarValue(valueProp, \"Component\");\n\n          if (hasVar) props[keyProp] = varValue;\n          if (!hasVar) props[keyProp] = valueProp;\n        }\n      } catch (error) {\n        // Silenciosamente ignora JSON inválido\n      }\n    }\n\n    return props;\n  }, [elementsProperties]);\n\n  const allProps = {\n    style: stl,\n    ...userElProps,\n  };\n\n  // ---------- set Render\n  if (!sttTypeFunc)\n    return <View {...allProps}>{mapElements(childrenItems, args)}</View>;\n\n  if (sttTypeFunc === \"on press\") {\n    allProps.children = mapElements(childrenItems, args);\n    allProps.onPress = async () => {\n      for (const currFunc of sttPressFuncs) await currFunc(args);\n    };\n\n    return <Pressable {...allProps} />;\n  }\n\n  if (sttTypeFunc === \"on init\")\n    return <View {...allProps}>{mapElements(childrenItems, args)}</View>;\n\n  if (sttTypeFunc === \"on listen\") {\n    const operatorFunc = OPERATORS[sttCondParts.operator as Tconds];\n    const condShow = operatorFunc?.(varValue, sttCondParts.compareVal);\n\n    return (\n      condShow && <View {...allProps}>{mapElements(childrenItems, args)}</View>\n    );\n  }\n};\n","newValue":"// ---------- import Packs\nimport JSON5 from \"json5\";\nimport React, { useEffect, useState } from \"react\";\nimport { Pressable, useWindowDimensions, View } from \"react-native\";\n\n// ---------- import Local Tools\nimport { useData } from \"../../..\";\nimport { getStlValues, getVarValue, mapElements, pathSel } from \"../project\";\n\nexport const css =\n  \"color: lightblue; background-color: black; font-size: 11px; padding: 2px 6px; border-radius: 3px\";\n\ntype Tconds = \"==\" | \"!=\" | \">\" | \"<\" | \"<=\" | \">=\";\ntype Tprops = {\n  pass: {\n    elementsProperties: any;\n    styles: string[];\n    functions: any[];\n    childrenItems: any;\n    args: any;\n  };\n};\n\nexport const processFunctions = async (arr: any[]) => {\n  const defaultVal = { trigger: \"\", arrFunctions: [] };\n\n  for (const fn of arr) {\n    if (typeof fn === \"function\") {\n      const result = await fn();\n      return result || defaultVal;\n    }\n  }\n\n  return defaultVal;\n};\n\nconst OPERATORS = {\n  \"==\": (a: any, b: any) => a == b,\n  \"!=\": (a: any, b: any) => a != b,\n  \">\": (a: any, b: any) => a > b,\n  \">=\": (a: any, b: any) => a >= b,\n  \"<\": (a: any, b: any) => a < b,\n  \"<=\": (a: any, b: any) => a <= b,\n} as const satisfies Record<Tconds, (a: any, b: any) => boolean>;\n\n// DynView / BOX\nexport const DynView = (props: Tprops) => {\n  if (!props) return <></>;\n  const { width } = useWindowDimensions();\n  const isMobile = width < 767;\n\n  const [sttTypeFunc, setTypeFunc] = useState(\"\");\n  const [sttCondParts, setCondParts] = useState({\n    path: \"\",\n    operator: \"==\",\n    compareVal: null,\n  });\n  const [sttPressFuncs, setPressFuncs] = useState<\n    Array<(args: any) => Promise<void>>\n  >([]);\n\n  const condRespVar = isMobile ? \"mobile\" : \"desktop\";\n\n  const condRespPath = React.useMemo(() => {\n    if (!sttCondParts.path) return \"\";\n    const isSpecialChar = sttCondParts.path.includes(\"@\");\n    return isSpecialChar\n      ? sttCondParts.path.replace(\"@media\", condRespVar)\n      : sttCondParts.path;\n  }, [sttCondParts.path, condRespVar]);\n\n  let varValue = useData((ct) =>\n    condRespPath ? pathSel(ct, condRespPath) : null,\n  );\n\n  // ---------- set Props\n  const { elementsProperties, functions } = props.pass;\n  const { childrenItems, args } = props.pass;\n  let { styles } = props.pass;\n\n  // ---- Media Breakpoints\n  const processedStyles = React.useMemo(() => {\n    if (!Array.isArray(styles)) {\n      return typeof styles === \"string\" ? [] : [];\n    }\n\n    return styles.map((style) => {\n      if (typeof style !== \"string\") return style;\n\n      if (isMobile) {\n        const mobilePart = style.match(\n          /@mediaMobiles*([sS]*?)(?=@mediaDesktop|$)/,\n        );\n        return mobilePart ? mobilePart[1] : style;\n      } else {\n        const desktopPart = style.match(/@mediaDesktops*([sS]*?)$/);\n        return desktopPart ? desktopPart[1] : style;\n      }\n    });\n  }, [styles, isMobile]);\n\n  const callFn = React.useCallback(async () => {\n    const { trigger, arrFunctions } = await processFunctions(functions);\n    setTypeFunc(trigger);\n    setPressFuncs(arrFunctions);\n\n    // ------- set Init Functions (Capsules)\n    if (trigger === \"on init\") {\n      for (const currFunc of arrFunctions) await currFunc(args);\n    }\n    if (trigger === \"on listen\") {\n      for (const currFunc of arrFunctions) {\n        const res: [string, Tconds, any] = await currFunc(args);\n        const path = res[0];\n        const operator = res[1];\n        const compareVal = res[2];\n\n        if (typeof path === \"string\") {\n          setCondParts({ path, operator, compareVal });\n        }\n      }\n    }\n  }, [functions, args]);\n\n  useEffect(() => {\n    callFn();\n  }, []);\n\n  // ---------- set Variables Styles (If Exists)\n  const stl = getStlValues(processedStyles);\n\n  // ------- set User Element Properties (If Exists)\n  const userElProps = React.useMemo(() => {\n    const props: any = {};\n\n    for (let strObj of elementsProperties) {\n      if (!strObj) continue;\n      if (typeof strObj !== \"string\") continue;\n\n      const trimmed = strObj.trim();\n      if (!trimmed.startsWith(\"{\") && !trimmed.startsWith(\"[\")) continue;\n\n      try {\n        const parsedObject = JSON5.parse(strObj);\n\n        for (const keyProp in parsedObject) {\n          const valueProp = parsedObject[keyProp];\n          const [hasVar, varValue] = getVarValue(valueProp, \"Component\");\n\n          if (hasVar) props[keyProp] = varValue;\n          if (!hasVar) props[keyProp] = valueProp;\n        }\n      } catch (error) {\n        // Silenciosamente ignora JSON inválido\n      }\n    }\n\n    return props;\n  }, [elementsProperties]);\n\n  const allProps = {\n    style: stl,\n    ...userElProps,\n  };\n\n  // ---------- set Render\n  if (!sttTypeFunc)\n    return <View {...allProps}>{mapElements(childrenItems, args)}</View>;\n\n  if (sttTypeFunc === \"on press\") {\n    allProps.children = mapElements(childrenItems, args);\n    allProps.onPress = async () => {\n      for (const currFunc of sttPressFuncs) await currFunc(args);\n    };\n\n    return <Pressable {...allProps} />;\n  }\n\n  if (sttTypeFunc === \"on init\")\n    return <View {...allProps}>{mapElements(childrenItems, args)}</View>;\n\n  if (sttTypeFunc === \"on listen\") {\n    const operatorFunc = OPERATORS[sttCondParts.operator as Tconds];\n    const condShow = operatorFunc?.(varValue, sttCondParts.compareVal);\n\n    return (\n      condShow && <View {...allProps}>{mapElements(childrenItems, args)}</View>\n    );\n  }\n};"}}