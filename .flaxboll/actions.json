{"1762195934237":{"actionType":"saveAll","createdAt":"1762195934237","actionID":"1762195934237","userID":"#TEMP","path":"system.capsules.371ae0c4-856b-4b4e-9a6a-a0a632e145e3.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"async () => {\n      const css1 =\n    \"color: limegreen; background-color: darkcyan; font-size: 11px; padding: 2px 6px; border-radius: 3px\";\n\n  const { getFirestore, doc, updateDoc } = await import(\"firebase/firestore\");\n\n  const fbInit = tools.getCtData(\"all.temp.fireInit\");\n  const db = getFirestore(fbInit);\n\n  \n  const stepId = tools.getCtData(\"sc.B9.forms.editChanges.stepId\");\n  console.log(\"%cstepId a atualizar:\", css1, { stepId });\n  const userId = tools.getCtData(\"sc.B9.currents.currId1\");\n  const data = tools.getCtData(\"sc.B9.forms.editChanges\");\n\n  try {\n    const refDoc = doc(db, \"users\", userId);\n\n    const dataToUpdate = {\n      [\"steps.\" + stepId]: { ...data },\n    };\n\n    await updateDoc(refDoc, dataToUpdate);\n\n    console.log(\"%cupdateDoc ok\", css1);\n    console.log(\"%cReferência do Documento\", css1, {\n      path: \"users.\" + userId,\n      dataToUpdate,\n    });\n  } catch (err) {\n    console.error(\"Erro do updateDoc\", { err });\n  }\n}","newValue":"async () => {\n      const css1 =\n    \"color: limegreen; background-color: darkcyan; font-size: 11px; padding: 2px 6px; border-radius: 3px\";\n\n  const { getFirestore, doc, updateDoc } = await import(\"firebase/firestore\");\n\n  const fbInit = tools.getCtData(\"all.temp.fireInit\");\n  const db = getFirestore(fbInit);\n\n  \n  const stepId = tools.getCtData(\"sc.B9.forms.editChanges.stepId\");\n  console.log(\"%cstepId a atualizar:\", css1, { stepId });\n  const userId = tools.getCtData(\"sc.B9.currents.currId1\");\n  const data = tools.getCtData(\"sc.B9.forms.editChanges\");\n\n  try {\n    const refDoc = doc(db, \"users\", userId);\n    const newId = stepId.replace(/\\./g, \"_\"); // substitui pontos por underscores\n\n    const dataToUpdate = {\n      [\"steps.\" + stepId]: { ...data },\n    };\n\n    await updateDoc(refDoc, dataToUpdate);\n\n    console.log(\"%cupdateDoc ok\", css1);\n    console.log(\"%cReferência do Documento\", css1, {\n      path: \"users.\" + newId,\n      dataToUpdate,\n    });\n  } catch (err) {\n    console.error(\"Erro do updateDoc\", { err });\n  }\n}"}}