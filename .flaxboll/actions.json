{"1764611403885":{"actionType":"saveAll","createdAt":"1764611403885","actionID":"1764611403885","userID":"#TEMP","path":"system.capsules.ee207416-dd0d-47f1-99b2-23c8123a7702.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"async () => {\n  const lotId = tools.getCtData(\"all.authUser.lotId\");\n\n  if (!lotId) {\n    console.log(\"ERRO: Usuário não tem lotId\");\n    return;\n  }\n\n  console.log(\"1️⃣ Buscando Lote:\", lotId);\n\n  // 1. WHERE para buscar o Lote\n  const lotResult = await tools.callWf({\n    wf: \"where\",\n    args: [\n      {\n        collection: \"lots\",\n        field: \"docId\",\n        operator: \"==\",\n        value: lotId\n      }\n    ]\n  });\n\n  console.log(\"Resultado do lote:\", lotResult);\n\n  if (!lotResult || !lotResult.docs || lotResult.docs.length === 0) {\n    console.log(\"Nenhum lote encontrado.\");\n    return;\n  }\n\n  const lotData = lotResult.docs;\n  tools.setData({\n    path: \"sc.C5.currents.lotData\",\n    value: lotData\n  });\n\n  const condoId = lotData[0].condoId;\n  console.log(\"CondoId do lote:\", condoId);\n\n  if (!condoId) {\n    console.log(\"ERRO: lote não tem condoId\");\n    return;\n  }\n\n  console.log(\"2️⃣ Buscando Condomínio:\", condoId);\n\n  // 2. WHERE para buscar o Condomínio\n  const condoResult = await tools.callWf({\n    wf: \"where\",\n    args: [\n      {\n        collection: \"condos\",\n        field: \"docId\",\n        operator: \"==\",\n        value: condoId\n      }\n    ]\n  });\n\n  console.log(\"Resultado do condomínio:\", condoResult);\n\n  tools.setData({\n    path: \"sc.C5.currents.condoData\",\n    value: condoResult.docs ?? []\n  });\n};\n","newValue":"async () => {\n  const lotId = tools.getCtData(\"all.authUser.lotId\");\n\n  if (!lotId) {\n    console.log(\"ERRO: Usuário não tem lotId\");\n    return;\n  }\n\n  console.log(\"1️⃣ Buscando Lote:\", lotId);\n\n  // 1. WHERE para buscar o Lote\n  const lotResult = await tools.callWf({\n    wf: \"where\",\n    args: [\n      {\n        collection: \"lots\",\n        field: \"docId\",\n        operator: \"==\",\n        value: lotId\n      }\n    ]\n  });\n\n  console.log(\"Resultado do lote:\", lotResult);\n\n  if (!lotResult || !lotResult.docs || lotResult.docs.length === 0) {\n    console.log(\"Nenhum lote encontrado.\");\n    return;\n  }\n\n  const lotData = lotResult.docs;\n  tools.setData({\n    path: \"sc.C5.currents.lotData\",\n    value: lotData\n  });\n\n  const condoId = lotData[0].condoId;\n  console.log(\"CondoId do lote:\", condoId);\n\n  if (!condoId) {\n    console.log(\"ERRO: lote não tem condoId\");\n    return;\n  }\n\n  console.log(\"2️⃣ Buscando Condomínio:\", condoId);\n\n  // 2. WHERE para buscar o Condomínio\n  const condoResult = await tools.callWf({\n    wf: \"where\",\n    args: [\n      {\n        collection: \"condos\",\n        field: \"docId\",\n        operator: \"==\",\n        value: condoId\n      }\n    ]\n  });\n\n  console.log(\"Resultado do condomínio:\", condoResult);\n\n  tools.setData({\n    path: \"sc.C5.currents.condoData\",\n    value: condoResult.docs ?? []\n  });\n}\n"}}