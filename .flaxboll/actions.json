{"1763486009769":{"actionType":"saveAll","createdAt":"1763486009769","actionID":"1763486009769","userID":"#TEMP","path":"system.capsules.a124cdd9-baac-4dcd-8aae-e725fad1cbb6.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números (sem regex)\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") clean += ch;\n    }\n\n    // Remove zeros à esquerda (mas deixa pelo menos um)\n    clean = clean.replace(/^0+/, \"\");\n    if (clean.length === 0) clean = \"0\";\n\n    // Constrói centavos e separadores\n    let intPart = clean.slice(0, -2);\n    let cents = clean.slice(-2);\n\n    // Se tiver só um dígito, considera como \"0X\"\n    if (clean.length === 1) {\n      intPart = \"0\";\n      cents = \"0\" + clean;\n    }\n\n    // Se tiver dois dígitos, é \"XX\" => 0,XX\n    if (clean.length === 2) {\n      intPart = \"0\";\n      cents = clean;\n    }\n\n    // Formata milhares manualmente (sem regex)\n    let intFormatted = \"\";\n    let counter = 0;\n\n    for (let i = intPart.length - 1; i >= 0; i--) {\n      intFormatted = intPart[i] + intFormatted;\n      counter++;\n      if (counter === 3 && i > 0) {\n        intFormatted = \".\" + intFormatted;\n        counter = 0;\n      }\n    }\n\n    const masked = \"R$ \" + intFormatted + \",\" + cents;\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.A10.forms.editChanges.value\"],\n        value: [String(masked)],\n      },\n    });\n  } catch (e) {\n    console.error(\"Erro na máscara BRL:\", e);\n    return txt;\n  }\n}","newValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números (sem regex)\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") clean += ch;\n    }\n\n    // Remove zeros à esquerda (mas deixa pelo menos um)\n    clean = clean.replace(/^0+/, \"\");\n    if (clean.length === 0) clean = \"0\";\n\n    // Constrói centavos e separadores\n    let intPart = clean.slice(0, -2);\n    let cents = clean.slice(-2);\n\n    // Se tiver só um dígito, considera como \"0X\"\n    if (clean.length === 1) {\n      intPart = \"0\";\n      cents = \"0\" + clean;\n    }\n\n    // Se tiver dois dígitos, é \"XX\" => 0,XX\n    if (clean.length === 2) {\n      intPart = \"0\";\n      cents = clean;\n    }\n\n    // Formata milhares manualmente (sem regex)\n    let intFormatted = \"\";\n    let counter = 0;\n\n    for (let i = intPart.length - 1; i >= 0; i--) {\n      intFormatted = intPart[i] + intFormatted;\n      counter++;\n      if (counter === 3 && i > 0) {\n        intFormatted = \".\" + intFormatted;\n        counter = 0;\n      }\n    }\n\n    const masked = \"R$ \" + intFormatted + \",\" + cents;\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.A7.forms.iptsChanges.totalValue\"],\n        value: [String(masked)],\n      },\n    });\n  } catch (e) {\n    console.error(\"Erro na máscara BRL:\", e);\n    return txt;\n  }\n}"}}