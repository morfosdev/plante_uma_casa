{"1766759390448":{"actionType":"saveAll","createdAt":"1766759390448","actionID":"1766759390448","userID":"#TEMP","path":"system.capsules.6192266a-8e6c-4a7e-a5e5-45d97e8410c9.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números (sem regex)\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") {\n        clean += ch;\n      }\n    }\n\n    // Limita a 8 dígitos (ddmmyyyy)\n    if (clean.length > 8) clean = clean.slice(0, 8);\n\n    console.log({ clean });\n\n    // Monta máscara dd/mm/aaaa\n    let masked = \"\";\n    if (clean.length > 0) masked = clean.slice(0, 2);         // dd\n    if (clean.length >= 3) masked += \"/\" + clean.slice(2, 4); // dd/mm\n    if (clean.length >= 5) masked += \"/\" + clean.slice(4, 8); // dd/mm/aaaa\n\n    console.log({ masked });\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.A7.forms.iptsChanges.endDate\"],\n        value: [String(masked)],\n      },\n    });\n  } catch (e) {\n    console.error(\"Erro na máscara de data:\", e);\n    return txt;\n  }\n}","newValue":"(txt) => {\n  try {\n    if (typeof txt !== \"string\") txt = String(txt ?? \"\");\n\n    // Mantém apenas números (sem regex)\n    let clean = \"\";\n    for (let i = 0; i < txt.length; i++) {\n      const ch = txt[i];\n      if (ch >= \"0\" && ch <= \"9\") {\n        clean += ch;\n      }\n    }\n\n    // Limita a 8 dígitos (ddmmyyyy)\n    if (clean.length > 8) clean = clean.slice(0, 8);\n\n    console.log({ clean });\n\n    // Monta máscara dd/mm/aaaa\n    let masked = \"\";\n    if (clean.length > 0) masked = clean.slice(0, 2);         // dd\n    if (clean.length >= 3) masked += \"/\" + clean.slice(2, 4); // dd/mm\n    if (clean.length >= 5) masked += \"/\" + clean.slice(4, 8); // dd/mm/aaaa\n\n    console.log({ masked });\n\n    tools.functions.setVar({\n      args: \"\",\n      pass: {\n        keyPath: [\"sc.A7.forms.editChanges.endDate\"],\n        value: [String(masked)],\n      },\n    });\n  } catch (e) {\n    console.error(\"Erro na máscara de data:\", e);\n    return txt;\n  }\n}"}}